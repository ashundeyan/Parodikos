<!DOCTYPE html>
<html>
	<!--<head>
		<title>Project Parodikos</title>
	</head>-->
	<pre id="mainText">Yo. Click <input type="button" value="here" onclick="mainMenu();"> to begin.</pre>
	<pre id="extraTextA" disabled></pre>
	<script>
		function playerCharacter(){
			this.nameSing="";
			this.generic=false;
			this.maxHealth=100;
			this.health=this.maxHealth;
		}
		function enemy(nameSingParam, namePlParam, genericParam, maxHealthParam){
			this.nameSing=nameSingParam;
			this.namePl=namePlParam;
			this.generic=genericParam;
			this.maxHealth=maxHealthParam;
			this.health=this.maxHealth;
		}
		function move(nameParam, executeParam, battleMessageParam){
			this.name=nameParam;
			this.execute=executeParam;
			this.battleMessage=battleMessageParam;
		}
		function mainMenu(){
			document.getElementById("mainText").innerHTML="<input type='button' value='New Game' onclick='newGame();'><br><br><input type='button' value='Load Game' onclick='loadGame();'>";
		}
		function newGame(){
			slash=new move("Slash",function(user, target){
				target.health-=10;
			},function(user, target, userOldHealth, targetOldHealth){
				var message="";
				if (user==player){
					message+="You";
				}
				else{
					if (user.generic==true){
						message+="The";
					}
					message+=" "+user.nameSing;
				}
				message+=" slashed";
				if (target==player){
					message+=" you";
				}
				else{
					if (target.generic==true){
						message+=" the";
					}
					message+=" "+target.nameSing;
				}
				message+=" for "+(targetOldHealth-target.health)+" damage!";
				return message;
			});
			player=new playerCharacter();
			beta=new enemy("Beta","Betae",true,20);
			setName();
		}
		function setName(){
			document.getElementById("mainText").innerHTML="What is your name?<br><input id='nameInput' type='text' autofocus><input type='button' value='Submit' onclick='difficulty();'>";
		}
		function difficulty(){
			player.nameSing=document.getElementById("nameInput").value;
			if (player.nameSing==""){
				return;
			}
			document.getElementById("mainText").innerHTML="What difficulty do you want to play on?<br>(This cannot be changed once set.)<br><br><input type='button' value='Normal' onclick='battle(beta)'>";
		}
		function battle(enemy){
			enemy.health=enemy.maxHealth;
			turnCount=0;
			battleDisplay(enemy,"");
		}
		function battleDisplay(enemy, battleText){
			var isAttackMenuExpanded=false;
			document.getElementById("mainText").innerHTML=enemy.nameSing+" HP: "+enemy.health+"<br><br><br>"+player.nameSing+" HP: "+player.health+"<br><br>"+battleText;
			document.getElementById("extraTextA").innerHTML="<input id='attackInput' type='button' value='Attack'>";
			//document.getElementById("attackInput").onclick=function(){battleTurn(player,enemy,slash);};
			document.getElementById("attackInput").onclick=function expandAttackMenu(){
				if (isAttackMenuExpanded==false){
					document.getElementById("extraTextA").innerHTML+="-----<input id='primaryAttackInput' type='button' value='Slash'>";
					document.getElementById("attackInput").onclick=function(){expandAttackMenu();};
					document.getElementById("primaryAttackInput").onclick=function(){battleTurn(player,enemy,slash);};
					isAttackMenuExpanded=true;
				}
				else{
					document.getElementById("extraTextA").innerHTML="<input id='attackInput' type='button' value='Attack'>";
					document.getElementById("attackInput").onclick=function(){expandAttackMenu();};
					isAttackMenuExpanded=false;
				}
			};
		}
		function battleTurn(player, enemy, playerMove){
			var oldPlayerHealth=player.health;
			var oldEnemyHealth=enemy.health;
			playerMove.execute(player,enemy);
			var enemyMove=slash;
			enemyMove.execute(enemy,player);
			if (player.health<=0){
				alert("You lost...");
			}
			if (enemy.health<=0){
				alert("You win!");
			}
			battleDisplay(enemy,playerMove.battleMessage(player,enemy,oldPlayerHealth,oldEnemyHealth)+"<br>"+enemyMove.battleMessage(enemy,player,oldEnemyHealth,oldPlayerHealth));
		}
	</script>
</html>
